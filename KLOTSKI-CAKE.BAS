' Klotski | IchigoCake BASIC
' Copyright (c) 2020-2025 Keiichi Shiga (BALLOON | FU-SEN)
' The MIT License (MIT) - https://mit.balloon.net.eu.org/#2020-2025
POKE#1780,255,128,128,128,128,128,128,128
POKE#1788,255,1,1,1,1,1,1,1
POKE#1790,128,128,128,128,128,128,128,255
POKE#1798,1,1,1,1,1,1,1,255
POKE#17A0,255,129,129,129,129,129,129,129
POKE#17B0,129,129,129,129,129,129,129,255
POKE#17C0,255,128,128,128,128,128,128,255
POKE#17C8,255,1,1,1,1,1,1,255
POKE#17E0,255,129,129,129,129,129,129,255
POKE#1800,240,0,241,0,242,0,243,0
POKE#1808,244,0,0,0,246,0,0,0
POKE#1810,248,0,249,0,0,0,0,0
POKE#1818,252,0,0,0,0,0,0,0

10 'ﾊｺｲﾘ ﾑｽﾒ
20 VIDEO 6:CLS
30 COPY #780,#1780,160
40 ?CHR$(244,240,241,244)
50 ?CHR$(246,242,243,246)
60 ?CHR$(244,248,249,244)
70 ?CHR$(246,252,252,246)
80 ?CHR$(252,1,1,252)
90 ?CHR$(0,2,2,0);
100 X=2:Y=4:M=0
110 LC X,Y,1
120 K=INKEY():IF !K CONT
130 IF K<>32 GOTO 160
140 IF !M AND SCR(X,Y)=1 GOTO 120
150 M=1-M:?CHR$(17);:GOTO 120
160 IF !M GOTO 380
170 P=SCR(X,Y):IF P=1 GOTO 380
180 P=P-240:Q=P%4:P=P-Q
190 A=X-Q%2:B=Y-Q/2
200 FOR S=0 TO 3
210 IF ![P+S] GOTO 230
220 LC A+S%2,B+S/2:?CHR$(1)
230 NEXT
240 C=A-(K=28)+(K=29)
250 D=B-(K=30)+(K=31):N=0
260 FOR S=0 TO 3
270 IF ![P+S] GOTO 290
280 IF SCR(C+S%2,D+S/2)<>1 N=1
290 NEXT
300 IF N=1 C=A:D=B:K=0
310 FOR S=0 TO 3
320 IF ![P+S] GOTO 350
330 LC C+S%2,D+S/2
340 ?CHR$([P+S])
350 NEXT
360 IF SCR(1,3)<>240 GOTO 380
370 LC 3,5:END
380 X=(X-(K=28)+(K=29)+4)%4
390 Y=(Y-(K=30)+(K=31)+5)%5
400 GOTO 110
